<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏±‡∏Å‡∏•‡∏∏‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô - Startup Up Real Estate</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
/* CSS ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏´‡∏ô‡∏î */
*{box-sizing:border-box} html, body { height: 100%; width: 100%; overflow: hidden; position: fixed; margin: 0; padding: 0; background-color: #ff4d6d; } .bg-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: url('https://lh3.googleusercontent.com/d/1K0BRvOY_r6-6YXI6VUbKDSMPivc9AE_E'); background-size: cover; background-position: center; background-repeat: no-repeat; z-index: -1; } @media (max-width: 768px) { .bg-container { background-image: url('https://lh3.googleusercontent.com/d/1ERUqVLPAj1DBJl_AhkY-1TCClSK1rTnq'); } } .bg-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.1); z-index: -1; } body { font-family: 'Sarabun', sans-serif; color: white; display: flex; flex-direction: column; align-items: center; justify-content: space-between; } h1 { text-align:center; margin: 4vh 0 0 0; font-size: clamp(18px, 5vw, 24px); text-shadow: 2px 2px 4px rgba(0,0,0,0.5); z-index: 5; } #regForm { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: center; z-index: 1000; } .reg-box { background: white; padding: 30px; border-radius: 20px; width: 90%; max-width: 320px; color: #333; } .reg-box h2 { color: #ff4d6d; margin-top: 0; text-align: center; } .reg-box input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; } .reg-box button { width: 100%; padding: 12px; background: #ff4d6d; color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; } #scene { position: relative; width: 100%; max-width: 360px; height: 55vh; display: flex; align-items: center; justify-content: center; } #shakeGroup { position: relative; width: 180px; height: 400px; transform-origin: bottom center; transition: transform 0.1s; } .shake { animation: shakeTube 0.5s infinite ease-in-out; } @keyframes shakeTube { 0%, 100% { transform: rotate(0deg); } 25% { transform: rotate(6deg); } 75% { transform: rotate(-6deg); } } .shake .stick { animation: stickDance 0.3s infinite alternate ease-in-out; } @keyframes stickDance { 0% { transform: rotate(var(--r)) translateY(0); } 100% { transform: rotate(calc(var(--r) * -1.2)) translateY(-20px); } } #tubeWrap { position: absolute; bottom: 0; width: 100%; height: 300px; z-index: 30; } #tube { position: absolute; bottom: 0; width: 100%; height: 100%; background: linear-gradient(90deg, #ff4d6d 0%, #ff85a1 20%, #ffb3c1 50%, #ff85a1 80%, #ff4d6d 100%); border-radius: 0 0 40px 40px; box-shadow: inset 0 15px 15px rgba(255,255,255,0.4), 0 10px 20px rgba(0,0,0,0.3); border: 2px solid #ff0a54; display: flex; justify-content: center; align-items: center; } .tubeLogo { width: 85%; height: auto; border-radius: 10px; display: block; } .stick { position: absolute; width: 24px; height: 260px; background: linear-gradient(to bottom, #fff0f3 0%, #ffccd5 15%, #ff85a1 15%, #ff4d6d 100%); border-radius: 6px 6px 2px 2px; bottom: 100px; z-index: 3; display: flex; justify-content: center; padding-top: 8px; font-size: 16px; font-weight: bold; color: #ff0a54; transition: transform 0.2s; } .s1{left:20px; transform: rotate(-8deg); --r:-8deg; animation-delay: 0.1s;} .s2{left:50px; transform: rotate(-3deg); --r:-3deg; animation-delay: 0.2s;} .s3{left:80px; transform: rotate(2deg); --r:2deg; animation-delay: 0.05s;} .s4{left:110px; transform: rotate(5deg); --r:5deg; animation-delay: 0.15s;} .s5{left:135px; transform: rotate(10deg); --r:10deg; animation-delay: 0.25s;} #mainStick{ left:78px; --r:0deg; animation-delay: 0.12s;} .fly { z-index: 20 !important; animation: smoothFly 1.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; } @keyframes smoothFly { 0% { transform: translateY(100px) rotate(0deg); opacity: 0; } 15% { opacity: 1; transform: translateY(-50px) rotate(5deg); } 40% { transform: translateY(-300px) rotate(20deg); } 70% { transform: translate(60px, -100px) rotate(90deg); } 100% { transform: translate(130px, 120px) rotate(160deg); } } button.draw-btn { width: 80%; max-width: 280px; padding: 16px; font-size: 20px; border: none; border-radius: 40px; background: linear-gradient(#ff85a1, #ff4d6d); color: white; font-weight: bold; box-shadow: 0 6px 0 #c9184a, 0 8px 15px rgba(0,0,0,0.3); cursor: pointer; margin-bottom: 5vh; } #overlay{ position:fixed; inset:0; background:rgba(0,0,0,.85); display:flex; align-items:center; justify-content:center; opacity:0; pointer-events:none; transition:.3s; z-index:999; } #overlay.show{ opacity:1; pointer-events:auto; } .card { width: 300px; height: auto; min-height: 420px; } .cardInner{ width:100%; height:100%; position:relative; transform-style:preserve-3d; transition:.6s; } .card.flip .cardInner{ transform:rotateY(180deg); } .face{ position:absolute; inset:0; backface-visibility:hidden; border-radius:20px; padding:20px; display:flex; flex-direction:column; align-items:center; justify-content:center; } .front{ background:#ff758f; color:white; font-size: 28px; font-weight: bold; border: 4px solid white; height: 420px; } .back{ background:#fff; color:#ff0a54; transform:rotateY(180deg); text-align: center; border: 4px solid #ff85a1; position: relative; height: auto; min-height: 420px;} .capture-fix { transform: none !important; backface-visibility: visible !important; } .closeBtn{ position:absolute; top:10px; right:10px; width:32px; height:32px; border-radius:50%; background:#ff4d6d; color:white; border: none; z-index: 10; } #promoText { margin-top: 10px; font-weight: bold; line-height: 1.4; color: #333; font-size: 13px; white-space: pre-line; } #previewScreen { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 2000; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 10px; } #previewImage { max-width: 240px; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.5); } .note-container { display: flex; gap: 5px; margin-top: 5px; width: 100%; } .note-send-btn { background: #4caf50; color: white; border: none; border-radius: 5px; padding: 0 12px; font-size: 12px; cursor: pointer; font-weight: bold; }
</style>
</head>

<body>
<div class="bg-container"></div>
<div class="bg-overlay"></div>

<div id="customAlert" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.85); z-index:10000; align-items:center; justify-content:center; padding: 20px;">
  <div style="background:white; padding:30px; border-radius:25px; width:100%; max-width:320px; text-align:center; color:#333; box-shadow: 0 15px 35px rgba(0,0,0,0.3);">
    <div id="alertIcon" style="font-size: 40px; margin-bottom: 15px;">üì¢</div>
    <p id="alertMsg" style="font-size:18px; font-weight:bold; margin-bottom:25px; line-height:1.5; color:#ff0a54;"></p>
    <button onclick="closeAlert()" style="width:100%; padding:14px; background:linear-gradient(#ff85a1, #ff4d6d); color:white; border:none; border-radius:15px; font-weight:bold; font-size:18px; cursor:pointer;">‡∏ï‡∏Å‡∏•‡∏á</button>
  </div>
</div>

<div id="regForm">
  <div class="reg-box">
    <h2>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏•‡∏∏‡πâ‡∏ô‡πÇ‡∏ä‡∏Ñ</h2>
    <input type="text" id="uName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
    <input type="tel" id="uTel" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (10 ‡∏´‡∏•‡∏±‡∏Å)" maxlength="10">
    <button id="regSubmitBtn" onclick="checkAndStart()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏±‡∏Å</button>
  </div>
</div>

<h1>üíñ ‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏±‡∏Å‡∏•‡∏∏‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô üíñ</h1>
<div id="scene">
  <div id="shakeGroup">
    <div class="stick s1">‚ù§</div><div class="stick s2">‚ù§</div><div class="stick s3">‚ù§</div>
    <div class="stick s4">‚ù§</div><div class="stick s5">‚ù§</div><div class="stick" id="mainStick">‚ù§</div>
    <div id="tubeWrap"><div id="tube"><img src="https://lh3.googleusercontent.com/d/1EEAbI2a89rG4ii0Um0cfWdXLtcb6I_RU" class="tubeLogo"></div></div>
  </div>
</div>
<button class="draw-btn" id="drawBtn" onclick="draw()" disabled style="opacity:0.5;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Å‡πà‡∏≠‡∏ô</button>

<div id="overlay">
  <div class="card" id="card">
    <div class="cardInner" id="cardInner">
      <div class="face front">‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏£‡∏±‡∏Å</div>
      <div class="face back" id="captureArea">
        <button class="closeBtn" onclick="closeCard()">√ó</button>
        <img src="https://lh3.googleusercontent.com/d/1EEAbI2a89rG4ii0Um0cfWdXLtcb6I_RU" style="width: 100px; margin-bottom: 5px;">
        <h2 id="cNo" style="margin:0; font-size: 18px;"></h2>
        <p id="cText" style="font-size: 18px; color: #ff4d6d; font-weight: bold; margin: 5px 0;"></p>
        <div style="font-size: 13px; color: #555; background: #fff0f3; padding: 5px 10px; border-radius: 10px; margin: 5px 0; width: 100%;">
          <span id="displayUserInfo"></span>
        </div>
        <hr style="width:100%; border: 0.5px solid #ffe5ec; margin: 5px 0;">
        <p id="promoText" style="margin: 5px 0;"></p>
        <div style="width: 100%; text-align: left; margin-top: 5px;">
          <label style="font-size: 11px; color: #888;">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</label>
          <div class="note-container">
            <input type="text" id="noteInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." style="flex: 1; border: 1px dashed #ffb3c1; border-radius: 5px; padding: 5px; font-size: 13px; outline: none; color: #333;">
            <button id="btnNote" class="note-send-btn" onclick="saveNoteOnly()">‡∏™‡πà‡∏á</button>
          </div>
        </div>
        <button id="saveBtn" onclick="saveAsImage()" style="margin-top:15px; background:#ff4d6d; color:#fff; border:none; padding:10px; border-radius:25px; font-weight:bold; width: 100%;">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</button>
        <a href="https://line.me/R/oaMessage/@sure141/üéâ‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ßüéâ" target="_blank" rel="noopener noreferrer" style="display:block; background:#06c755; color:#fff; text-align:center; padding:14px; border-radius:20px; font-weight:bold; text-decoration:none; margin-top: 10px;">üí¨ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡πà‡∏≤‡∏ô LINE OA</a>
      </div>
    </div>
  </div>
</div>

<div id="previewScreen">
  <h3 id="previewHint">‡πÅ‡∏ï‡∏∞‡∏Ñ‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠ '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å'</h3>
  <img id="previewImage" src="">
  <button onclick="closePreview()" style="margin-top:20px; background:#666; border:none; padding:10px 20px; color:white; border-radius:10px; cursor: pointer;">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw9zHGwLl6Z7NzUGvwAaoPsRaeBj7UxHjAhAl87xNkFrn6XI6SFFmpMUC2Aic1G-Y2qzQ/exec";
let currentUser = null;
let lastResultText = ""; 
const data=[{no:"1", text:"‡∏ó‡∏£‡∏¥‡∏õ‡∏î‡∏¥‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏´‡∏£‡∏π + ‡πÇ‡∏ã‡∏ü‡∏≤‡∏Ñ‡∏π‡πà‡∏£‡∏±‡∏Å"},{no:"2", text:"‡∏ï‡∏π‡πâ‡πÄ‡∏¢‡πá‡∏ô‡πÉ‡∏´‡∏ç‡πà + ‡∏ä‡∏∏‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ß‡∏ä‡∏°‡∏û‡∏π"},{no:"3", text:"‡πÅ‡∏≠‡∏£‡πå‡πÄ‡∏¢‡πá‡∏ô‡∏â‡πà‡∏≥ + ‡∏ó‡∏µ‡πà‡∏ô‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏á‡πÑ‡∏ã‡∏™‡πå"},{no:"4", text:"‡πÅ‡∏´‡∏ß‡∏ô‡∏ó‡∏≠‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ó‡∏ô‡πÉ‡∏à 1 ‡∏™‡∏•‡∏∂‡∏á"}];
const slogans = [
  "‡∏Å‡∏π‡πâ‡∏á‡πà‡∏≤‡∏¢ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÑ‡∏ß ‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏ô‡∏ù‡∏±‡∏ô‡∏Å‡∏±‡∏ö Startup Up Real Estate\n‡∏ú‡πà‡∏≠‡∏ô‡∏™‡∏ö‡∏≤‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏¢‡∏∑‡πà‡∏ô‡∏Å‡∏π‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ‡∏ü‡∏£‡∏µ‡∏ó‡∏±‡∏ô‡πÉ‡∏à!",
  "‡∏≠‡∏¢‡∏≤‡∏Å‡∏°‡∏µ‡∏ö‡πâ‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏≤‡∏Å Startup Up ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏Å‡∏π‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡πÉ‡∏à\n‡∏ß‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ‡∏™‡∏π‡∏á ‡∏Å‡∏π‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏£‡πâ‡∏≠‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≤‡∏ß‡∏ô‡πå ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏î‡∏π‡πÅ‡∏•‡∏ó‡∏∏‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô!",
  "‡∏£‡∏±‡∏Å‡∏´‡∏ß‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏ß‡∏¢ ‡∏¢‡∏∑‡πà‡∏ô‡∏Å‡∏π‡πâ‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡∏±‡∏ö Startup Up ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏£‡πá‡∏ß‡∏ä‡∏±‡∏ß‡∏£‡πå\n‡∏î‡∏π‡πÅ‡∏•‡∏ó‡∏∏‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì",
  "‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡πÄ‡∏à‡∏≠‡∏£‡∏±‡∏Å ‡∏£‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡∏™‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°\n‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡πà‡∏≥ ‡∏ú‡πà‡∏≠‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏¢‡∏≤‡∏ß‡πÜ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏ô‡∏ù‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!",
  "‡∏£‡∏±‡∏Å‡πÅ‡∏ó‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡∏¢‡∏∑‡πà‡∏ô‡∏Å‡∏π‡πâ‡∏ö‡πâ‡∏≤‡∏ô‡∏Å‡∏±‡∏ö Startup Up ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ\n‡∏Å‡∏π‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÑ‡∏ß ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏¢!"
];

function showAlert(msg, icon = "üì¢") {
  document.getElementById('alertMsg').innerText = msg;
  document.getElementById('alertIcon').innerText = icon;
  document.getElementById('customAlert').style.display = 'flex';
}
function closeAlert() { document.getElementById('customAlert').style.display = 'none'; }

async function checkAndStart() {
  const name = document.getElementById('uName').value;
  const tel = document.getElementById('uTel').value;
  if(!name || tel.length < 10) return showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö', "‚ö†Ô∏è");
  const submitBtn = document.getElementById('regSubmitBtn');
  submitBtn.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå...";
  submitBtn.disabled = true;
  try {
    const response = await fetch(`${SCRIPT_URL}?phone=${tel}`);
    const result = await response.json();
    
    // ‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏Ñ‡∏¢‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß
    if(result.exists) {
      currentUser = { name: result.name || name, tel: tel };
      lastResultText = result.result || "‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì";
      
      // ‡∏î‡∏∂‡∏á‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
      let foundNo = "1";
      data.forEach(d => { if(lastResultText.includes(d.text)) foundNo = d.no; });

      document.getElementById('regForm').style.display = 'none';
      
      // ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
      document.getElementById('cNo').innerText = "‡πÉ‡∏ö‡∏ó‡∏µ‡πà " + foundNo;
      document.getElementById('cText').innerText = "‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö: " + lastResultText;
      document.getElementById('displayUserInfo').innerText = `‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ: ${currentUser.name} (${currentUser.tel})`;
      document.getElementById('promoText').innerText = slogans[0]; 
      document.getElementById('overlay').classList.add("show");
      document.getElementById('card').classList.add("flip");
      
      // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö
      showAlert(`‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ñ‡∏¢‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö\n‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏∑‡∏≠: ${lastResultText}`, "‚úÖ");
      return;
    }
    
    currentUser = { name, tel };
    document.getElementById('regForm').style.display = 'none';
    const drawBtn = document.getElementById('drawBtn');
    drawBtn.disabled = false;
    drawBtn.style.opacity = '1';
    drawBtn.innerText = '‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡∏´‡∏±‡∏ß‡πÉ‡∏à';
  } catch (err) {
    showAlert("‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏Ñ‡∏£‡∏π‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö", "‚öôÔ∏è");
    submitBtn.disabled = false;
    submitBtn.innerText = "‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏±‡∏Å";
  }
}

async function draw(){
  const drawBtn = document.getElementById('drawBtn');
  drawBtn.disabled = true;
  document.getElementById('shakeGroup').classList.add("shake");
  setTimeout(async ()=>{
    document.getElementById('shakeGroup').classList.remove("shake");
    const pick = data[Math.floor(Math.random()*data.length)];
    const randomSlogan = slogans[Math.floor(Math.random()*slogans.length)];
    document.getElementById('mainStick').innerText = pick.no; 
    document.getElementById('mainStick').classList.add("fly");
    lastResultText = pick.text;
    saveToGoogleSheet(currentUser.name, currentUser.tel, pick.text, "‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏•‡πâ‡∏ß"); 
    setTimeout(()=>{
      document.getElementById('cNo').innerText = "‡πÉ‡∏ö‡∏ó‡∏µ‡πà "+pick.no;
      document.getElementById('cText').innerText = "‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö: " + pick.text;
      document.getElementById('displayUserInfo').innerText = `‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ: ${currentUser.name} (${currentUser.tel})`;
      document.getElementById('promoText').innerText = randomSlogan;
      document.getElementById('overlay').classList.add("show");
      setTimeout(() => {
        document.getElementById('card').classList.add("flip");
        setTimeout(() => { showAlert("‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÅ‡∏Ñ‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÉ‡∏ö‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ\n‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö", "üì∏"); }, 800);
      }, 200);
    }, 600); 
  }, 3000); 
}

function closeCard() {
  document.getElementById('overlay').classList.remove("show");
  document.getElementById('card').classList.remove("flip");
  const drawBtn = document.getElementById('drawBtn');
  drawBtn.innerText = '‡∏î‡∏π‡∏ú‡∏•‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á';
  drawBtn.disabled = false;
  drawBtn.style.opacity = '1';
  drawBtn.onclick = function() {
    document.getElementById('overlay').classList.add("show");
    setTimeout(() => { document.getElementById('card').classList.add("flip"); }, 200);
  };
}

async function saveNoteOnly() { const noteVal = document.getElementById('noteInput').value; if(!noteVal) return showAlert("‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö", "‚úçÔ∏è"); await saveToGoogleSheet(currentUser.name, currentUser.tel, lastResultText, noteVal); showAlert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÅ‡∏•‡πâ‡∏ß", "‚úÖ"); }
async function saveToGoogleSheet(name, phone, result, note) { try { const formData = new URLSearchParams(); formData.append('name', name); formData.append('phone', phone); formData.append('result', result); formData.append('note', note); fetch(SCRIPT_URL, { method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/x-www-form-urlencoded' }, body: formData.toString() }); } catch (err) {} }
function closePreview() { document.getElementById('previewScreen').style.display = 'none'; }
function saveAsImage() { /* ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û‡πÄ‡∏î‡∏¥‡∏° */ }
</script>
</body>
</html>
